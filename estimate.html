<script>
// Function to determine local multiplier
function getLocalMultiplier(zip) {
    const austinZips = [78701, 78702, 78703, 78704, 78705, 78723, 78741, 78745, 78746];
    const sanAntonioZips = [78201, 78202, 78203, 78204, 78205, 78209, 78210, 78211, 78212];
    if (austinZips.includes(zip)) return 1.08; // +8% for Austin
    if (sanAntonioZips.includes(zip)) return 1.00; // base for San Antonio
    return 1.00; // default for other TX ZIPs
}

// Updated estimate function
function calculateEstimate(){
    let [minEstimate, maxEstimate] = getEstimateRange(answers.service, answers.problem);
    const quantity = parseInt(answers.quantity) || 1;
    minEstimate *= quantity;
    maxEstimate *= quantity;

    // Floor/accessibility adjustment
    if(answers.floor === "Second Floor or Higher") { minEstimate +=50; maxEstimate +=50; }
    if(answers.accessibility === "Hard Access / Stairs") { minEstimate +=50; maxEstimate +=50; }

    // Distance adjustment (approx $10 per ~10 zip difference)
    const zip = parseInt(answers.zip) || 78251;
    const distance = Math.abs(zip - 78251)/10;
    minEstimate += distance*10;
    maxEstimate += distance*10;

    // Apply local multiplier
    const localMultiplier = getLocalMultiplier(zip);
    minEstimate *= localMultiplier;
    maxEstimate *= localMultiplier;

    displayMessage(`ðŸ’µ Preliminary Estimate Range: $${minEstimate.toFixed(0)} â€“ $${maxEstimate.toFixed(0)}\n*Note: Final pricing confirmed after inspection by a licensed plumber.*`,"bot");

    // Send data via FormSubmit
    const formData = new FormData();
    for(let key in answers){
        formData.append(key, answers[key]);
    }
    formData.append("_captcha","false");
    formData.append("_subject","New AI Estimate Submission");
    formData.append("_template","table");

    fetch("https://formsubmit.co/9f7e5896f9be69b62056c861f68e17e3", {
        method:"POST",
        body: formData
    });
}
</script>
// Base estimate
let baseEstimate = 0;
switch(service){
  case "Repair": baseEstimate = 100; break;
  case "Replacement (Remove + Install)": baseEstimate = 250; break;
  case "Renovation": baseEstimate = 500; break;
  case "New Build": baseEstimate = 1000; break;
}

// Adjust for problem type
if(problem.includes("Toilet") || problem.includes("Garbage")) baseEstimate *= 1.2;
else if(problem.includes("Water Heater")) baseEstimate *= 1.5;

// Adjust for distance (crude estimate)
const baseZip = 78251;
const distance = Math.abs(zip - baseZip)/10;
baseEstimate += distance * 10;

// Adjust for floor/accessibility
if(floor === "Second Floor or Higher") baseEstimate += 50;
if(accessibility === "Hard to Access / Stairs") baseEstimate += 50;

// Display preliminary estimate
document.getElementById('estimateResult').innerHTML = `
<h3>Preliminary Estimate: $${baseEstimate.toFixed(0)}</h3>
<p>Note: This is a preliminary estimate. Final pricing may vary after inspection by a licensed plumber.</p>
`;
});
</script>

<footer>
<p>Â© 2025 Plumbing Gurus. Dispatch & referral services only.</p>
<p>
<a href="terms.html" style="color:white; text-decoration:underline;">Terms & Conditions</a> | 
<a href="privacy.html" style="color:white; text-decoration:underline;">Privacy Policy</a>
</p>
</footer>

</body>
</html>
